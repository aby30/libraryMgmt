{"ast":null,"code":"import sqlite from 'sqlite';\nexport default (async (req, res) => {\n  res.statusCode = 200;\n  const db = await sqlite.open('./library.sqlite');\n  const books1st = await db.all('select * from books');\n  console.log(`bookList 1stttttttttt--->${JSON.stringify(books1st)}`);\n  console.log(`req.body--->${JSON.parse(req.body).length}`);\n  const reqBody = JSON.parse(req.body);\n\n  if (req.body.length > 0) {\n    for (let index = 0; index < reqBody.length; index++) {\n      const statement = await db.prepare('UPDATE books SET availableQty= ? where bookId= ? ');\n      const result = await statement.run(reqBody[index].availableQty - 1, reqBody[index].bookId);\n      console.log(`result---->${result}`);\n      result.finalize();\n    }\n  } //   const books = await db.all(`update books bookId = ${req.body.bookId}`);\n\n\n  const books2nd = await db.all('select * from books');\n  console.log(`req--->${req.body}`);\n  console.log(`bookList 2nddddddd--->${JSON.stringify(books2nd)}`);\n  res.json({\n    data: 'Borrowed succesfully'\n  });\n});","map":{"version":3,"sources":["/Users/Abhipray 1/Desktop/MY home/mYY work/HEXAD_assignment/Hexad_trial_code/hexd/pages/api/borrowBooks.js"],"names":["sqlite","req","res","statusCode","db","open","books1st","all","console","log","JSON","stringify","parse","body","length","reqBody","index","statement","prepare","result","run","availableQty","bookId","finalize","books2nd","json","data"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjCA,EAAAA,GAAG,CAACC,UAAJ,GAAiB,GAAjB;AACA,QAAMC,EAAE,GAAG,MAAMJ,MAAM,CAACK,IAAP,CAAY,kBAAZ,CAAjB;AACA,QAAMC,QAAQ,GAAG,MAAMF,EAAE,CAACG,GAAH,CAAO,qBAAP,CAAvB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAa,4BAA2BC,IAAI,CAACC,SAAL,CAAeL,QAAf,CAAyB,EAAjE;AAEAE,EAAAA,OAAO,CAACC,GAAR,CAAa,eAAcC,IAAI,CAACE,KAAL,CAAWX,GAAG,CAACY,IAAf,EAAqBC,MAAO,EAAvD;AAEA,QAAMC,OAAO,GAAGL,IAAI,CAACE,KAAL,CAAWX,GAAG,CAACY,IAAf,CAAhB;;AAEA,MAAIZ,GAAG,CAACY,IAAJ,CAASC,MAAT,GAAkB,CAAtB,EAAyB;AACvB,SAAK,IAAIE,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGD,OAAO,CAACD,MAApC,EAA4CE,KAAK,EAAjD,EAAqD;AACjD,YAAMC,SAAS,GAAG,MAAMb,EAAE,CAACc,OAAH,CAAW,mDAAX,CAAxB;AACA,YAAMC,MAAM,GAAG,MAAMF,SAAS,CAACG,GAAV,CACjBL,OAAO,CAACC,KAAD,CAAP,CAAeK,YAAf,GAA4B,CADX,EAEjBN,OAAO,CAACC,KAAD,CAAP,CAAeM,MAFE,CAArB;AAIAd,MAAAA,OAAO,CAACC,GAAR,CAAa,cAAaU,MAAO,EAAjC;AACAA,MAAAA,MAAM,CAACI,QAAP;AACH;AACF,GApBgC,CAqBnC;;;AACE,QAAMC,QAAQ,GAAG,MAAMpB,EAAE,CAACG,GAAH,CAAO,qBAAP,CAAvB;AAGAC,EAAAA,OAAO,CAACC,GAAR,CAAa,UAASR,GAAG,CAACY,IAAK,EAA/B;AACAL,EAAAA,OAAO,CAACC,GAAR,CAAa,yBAAwBC,IAAI,CAACC,SAAL,CAAea,QAAf,CAAyB,EAA9D;AACAtB,EAAAA,GAAG,CAACuB,IAAJ,CAAS;AACPC,IAAAA,IAAI,EAAE;AADC,GAAT;AAGD,CA9BD","sourcesContent":["import sqlite from 'sqlite';\n\nexport default async (req, res) => {\n  res.statusCode = 200;\n  const db = await sqlite.open('./library.sqlite');\n  const books1st = await db.all('select * from books');\n  console.log(`bookList 1stttttttttt--->${JSON.stringify(books1st)}`);\n\n  console.log(`req.body--->${JSON.parse(req.body).length}`);\n\n  const reqBody = JSON.parse(req.body);\n\n  if (req.body.length > 0) {\n    for (let index = 0; index < reqBody.length; index++) {\n        const statement = await db.prepare('UPDATE books SET availableQty= ? where bookId= ? ');\n        const result = await statement.run(\n            reqBody[index].availableQty-1,\n            reqBody[index].bookId,\n        )\n        console.log(`result---->${result}`);\n        result.finalize();\n    }\n  }\n//   const books = await db.all(`update books bookId = ${req.body.bookId}`);\n  const books2nd = await db.all('select * from books');\n\n\n  console.log(`req--->${req.body}`);\n  console.log(`bookList 2nddddddd--->${JSON.stringify(books2nd)}`);\n  res.json({ \n    data: 'Borrowed succesfully'\n  });\n}\n"]},"metadata":{},"sourceType":"module"}